<!DOCTYPE html>
<html lang="en-us">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>
MonitorsFour | ARTIFACTS
</title>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">

<meta name="generator" content="Hugo 0.152.2">


<link rel="canonical" href="http://localhost:1313/captures/monitorsfour/" >




<link href="/css/style.min.5f46e10d3d75c0ba6553d0749280b20ce50648a191585d2b90bfa5a77f1653cd.css" rel="stylesheet">




</head>

<body>

    <div class="flexWrapper">
        <header class="headerWrapper">
    <div class="header">
        <div>
            <a class="terminal" href="/">
                <span>C-1485@artifacts.io ~ $</span>
            </a>
        </div>
        <input class="side-menu" type="checkbox" id="side-menu">
        <label class="hamb" for="side-menu"><span class="hamb-line"></span></label>
        <nav class="headerLinks">
            <ul>
                
                <li>
                    <a href="http://localhost:1313/posts" title="" >
                        ~/posts</a>
                </li>
                
                <li>
                    <a href="http://localhost:1313/captures" title="" >
                        ~/captures</a>
                </li>
                
                <li>
                    <a href="http://localhost:1313/about" title="" >
                        ~/about</a>
                </li>
                
            </ul>
        </nav>
    </div>
</header>


        <div class="content">
            <main class="main">
                
<div class="postWrapper">
    <h1>MonitorsFour</h1>
    

    
    
    
    

    
    
    
    
    

    
    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    
    
    

    
    <section class="postMetadata">
        <dl>
            
                <dt>tags</dt>
<dd><span></span>HackTheBox Machines</dd>
            
            
            
            
            
            
                <dt>reading time</dt>
                <dd>2 minutes</dd>
            
        </dl>
    </section>
    
    <div>
        <h4 id="write-up-for-the-hackthebox-machine---monitorsfour">Write-Up for the HackTheBox Machine - MonitorsFour</h4>
<hr>
<h4 id="001-scan">001: Scan</h4>
<p>The victim machine was scanned using <code>nmap</code>.
Ports returned from the tool were <code>port 80(http)</code> and <code>port 5985 (winrm)</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sC -sV -p- 10.10.11.98
</span></span></code></pre></div><p align="center">
  <img src="/captures/screens/MonitorsFour/shot-001.png" alt="shot-001">
</p>
<hr>
<h4 id="002-hostname-mapping">002: Hostname Mapping</h4>
<p>Then, the IP of the victim is added to <code>/etc/hosts</code> and mapped to <code>monitorsfour.htb</code> for local hostanme resolution.
Thus, the website was viewed in browser for further examination.</p>
<p align="center">
  <img src="/captures/screens/MonitorsFour/shot-002.png" alt="shot-002">
</p>
<hr>
<h4 id="003-victim-fuzz">003: Victim Fuzz</h4>
<p>As the <code>nmap</code> report showed that the application was running on nginx, additional reconnaissance for the discovery of hidden files and subdomains was made using <code>ffuf</code>.
<code>common.txt</code> wordlist exposed various paths, but what seemed most interesting was the <strong>Warning</strong> from <code>/contact</code> response.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -u http://monitorsfour.htb/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -ac
</span></span></code></pre></div><ul>
<li><code>-ac</code> | switch specifies auto-calibration, which filters out false positive responses</li>
</ul>
<p align="center">
  <img src="/captures/screens/MonitorsFour/shot-003.png" alt="shot-003">
</p>
<p>Initially, the response appeared like a hint that the victim may be vulnerable to File Inclusion.
But after some common LFI probes to <code>/contact</code> and <code>/Router</code>, no results were found of potential vulnerability.
However, <code>/Router.php</code> when tested in <code>burpsuite</code> all responses returned <code>200 OK</code>, meaning that requests were handled on the server.</p>
<p align="center">
  <img src="/captures/screens/MonitorsFour/shot-004.png" alt="shot-004">
</p>
<hr>
<h4 id="004-virtual-host">004: Virtual Host</h4>
<p><code>/Router.php</code> was assumed to be a front controller, since it is explicitly named <code>Router</code> and calls a prefix path <code>/var/www/app/</code>, which basically implied a centralized request handler to other website components.
Hence, with <code>ffuf</code> the victim was probed for hidden subdomains.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -u http://FUZZ.monitorsfour.htb/ -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -ac
</span></span></code></pre></div><p>Enumeration for DNS subdomains returned nothing.
But, then the logical next step was probing for any virtual host.
After few seconds virtual host <code>cacti</code> was found with a redirection status <code>302</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -u http://FUZZ.monitorsfour.htb/ -H <span style="color:#e6db74">&#34;Host: FUZZ.monitorsfour.htb&#34;</span> -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -ac
</span></span></code></pre></div><ul>
<li><code>-H</code> | switch specifies virtual host fuzzing</li>
</ul>
<p align="center">
  <img src="/captures/screens/MonitorsFour/shot-005.png" alt="shot-005">
</p>
<hr>
    </div>
</div>

            </main>
        </div>


        <footer class="footer">
    
        <span>
            ♣ ♦ ♠ ♥ 
        </span>
    
</footer>
    </div>

</body>

</html>
